## Генератор хокку на основе маскированной диффузионной модели
### Описание

Данный проект представляет собой диффузионную языковую модель для генерации хокку – кратких трёхстрочных стихотворений – с жёстко заданной слоговой структурой 5-7-5. В основе лежит алгоритм Masked-Diffuse LM, который адаптирован для поэтического текста. Модель обучена итеративно восстанавливать частично замаскированный текст, что позволяет генерировать стихи неавторегрессивно (не слева-направо, а заполняя пропуски по мере уточнения). Ключевая особенность – встроенный контроль числа слогов в каждой строке: при генерации модель гарантированно соблюдает структуру хокку (пять слогов в первой строке, семь – во второй, пять – в третьей). Проект демонстрирует, как методы диффузионного текстового моделирования могут быть использованы для творческих задач и строго контролируемого генеративного процесса.

### Архитектура решения

Диффузионная модель языка: В основе генератора – трансформер (BERT), обученный методом маскированного моделирования. Обучение происходит в парадигме диффузионной модели: текст постепенно искажается (часть слов заменяется на [MASK]), а модель учится восстанавливать оригинал по зашумленной версии.
Прямой процесс (маскирование): При обучении мы постепенно маскируем исходный текст – сначала самые значимые слова (например, редкие или ключевые по смыслу), затем более простые. 

Обратный процесс (генерация): Генерация начинается с пустого шаблона хокку (все токены неизвестны). Затем модель итеративно восстанавливает текст: сперва вставляются наиболее простые и очевидные слова (например, служебные), потом всё более “информативные” слова. Благодаря этому модель генерирует естественно читающийся текст, заполняя пропуски на месте масок. Процесс завершается, когда все маски заполнены и получено готовое стихотворение.

Контроль структуры 5-7-5: В алгоритм генерации встроены правила, следящие за количеством слогов. После заполнения каждого слова пересчитываются слоги в текущей строке. Если достигнуто требуемое число (5 или 7), модель вставляет символ переноса строки и не позволяет данной строке вырасти длиннее. Это достигается как за счёт специального расписания маскирования (нужные разрывы строк маскируются в последнюю очередь), так и пост-обработкой на каждом шаге генерации (лишние слова маскируются обратно). Такое решение гарантирует, что структура хокку соблюдается без посторонней фильтрации – ограничения заложены прямо в модель.

- **diffusion.py** — основные классы и функции диффузионного процесса:
  - расписание β (линейное, косинусное и др.);
  - класс `GaussianDiffusion` для обучения и сэмплинга;
  - подсчёт важности токенов по количеству слогов.
- **main.py** — скрипт для обучения модели и генерации хайку:
  - подготовка датасета из CSV-файла;
  - обучение денойзера (`BertDenoiser`);
  - сохранение весов и визуализация кривой обучения;
  - финальный запуск генерации и вывод результата.

### Пример результата
the dragon eats prey

summer breeze on high hills 

hopes in shaded glen
